/*
 Simrou - Simple javascript routing framework
 Copyright (c) 2012 büro für ideen, www.buero-fuer-ideen.de
*/
(function(d,m,p){var k,q=/[-[\]{}()+?.,\\^$|#\s]/g,r=/:\w*/g,s=/\*\w*/g;k=function(g){var a=this,e,i=function(b,c){!c&&d.isFunction(b)&&(c=b,b="*");d(a).on("simrou:"+b.toLowerCase(),c);return a},j=function(b){return function(a){return i(b,a)}};a.match=function(a){a=e.exec(a);return!d.isArray(a)?!1:a.slice(1)};a.getRegExp=function(){return e};a.attachAction=i;a.attachActions=function(b,c){if(d.isArray(b))c={"*":b};else if(d.isPlainObject(b))c=b;else{var h={};h[b]=c;c=h}for(b in c){h=c[b];d.isArray(h)||
(h=[h]);for(var e=0;e<h.length;e++)i(b,h[e])}return a};a.detachAction=function(b,c){!c&&d.isFunction(b)&&(c=b,b="*");d(a).off("simrou:"+b.toLowerCase(),d.isFunction(c)?c:p);return a};a.get=j("get");a.post=j("post");a.put=j("put");a["delete"]=a.del=j("delete");e=g instanceof RegExp?g:(g=(""+g).replace(q,"\\$&").replace(r,"([^/]+)").replace(s,"(.*?)"))?RegExp("^"+g+"$"):/^.+$/};m.Simrou=function(g){var a=this,e=m.location,i={},j=!1,b=function(a,b){var f=a instanceof k?a:new k(a);b&&(d.isFunction(b)?
f.attachAction(b):f.attachActions(b));return i[""+f.getRegExp()]=f},c=function(a){var c;if(d.isArray(a)){c=[];for(var f=0;f<a.length;f++)c.push(b(a[f]))}else for(f in c={},a)c[f]=b(f,a[f]);return c},h=function(b){var c=e.hash!=b;e.hash=b;(!j||!c)&&l(b,"get");return a},l=function(a,b){var c=!1,e,h,g;if(!a)return!1;for(h in i)e=i[h],g=e.match(a),!1!==g&&(g.unshift(b),c=d(e),c.trigger("simrou:*",g),b&&c.trigger("simrou:"+b.toLowerCase(),g),c=!0);return c},n=function(){l(e.hash.replace(/^#*(.*)$/,"$1"),
"get")},o=function(){var a=d(this),b=""+a.attr("method")||"get",a=a.attr("action");return!l(a,b)};a.version="1.1.1";a.registerRoute=b;a.registerRoutes=c;a.removeRoute=function(b){b instanceof k||(b=new k(b));b=""+b.getRegExp();i[b]&&delete i[b];return a};a.start=function(b,c){c||(d(m).on("hashchange",n),j=!0);d("body").on("submit","form",o);var f=e.hash.replace(/^#*(.*)$/,"$1");""==f?b&&h(b):l(f,"get");return a};a.stop=function(){d(m).off("hashchange",n);j=!1;d("body").off("submit","form",o);return a};
a.navigate=h;a.resolve=l;g&&c(g)}})(jQuery,window);