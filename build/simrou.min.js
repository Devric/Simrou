/*
 Simrou v1.5.0 - Released under the MIT License.
 Copyright (c) 2012 büro für ideen, www.buero-fuer-ideen.de
*/
(function(){var j,l,m=function(b,a){return function(){return b.apply(a,arguments)}},k={}.hasOwnProperty,n=[].slice;l=function(){function b(a){this.handleFormSubmit=m(this.handleFormSubmit,this);this.resolveHash=m(this.resolveHash,this);this.routes={};this.observingForms=this.observingHash=!1;null!=a&&this.addRoutes(a)}b.prototype.RegExpCache={extractHash:/^[^#]*(#.*)$/,trimHash:/^#*(.*?)\/*$/};b.prototype.eventSupported=function(){var a;a=window.document.documentMode;return"onhashchange"in window&&
(null==a||7<a)}();b.prototype.createRoute=function(a,c){null==c&&(c=!0);return a instanceof j?a:new j(a,c)};b.prototype.addRoute=function(a,c){var d;null==c&&(c=!0);d=this.createRoute(a,c);return this.routes[d.toString()]=d};b.prototype.addRoutes=function(a,c){var d,f,g,b;null==c&&(c=!0);if($.isFunction(a))f=a.call(this,c);else if($.isArray(a)){f=[];d=0;for(g=a.length;d<g;d++)b=a[d],f.push(this.addRoutes(b,c))}else if($.isPlainObject(a))for(g in f={},a)k.call(a,g)&&(d=a[g],b=this.addRoute(g,c),b.attachActions(d),
f[g]=b);else f=this.addRoute(a,c);return f};b.prototype.removeRoute=function(a){a instanceof j||(a=new j(a));a=a.toString();if(a in this.routes)return delete this.routes[a]};b.prototype.navigate=function(a){var c;c=this.getHash();location.hash=a;if(!this.observingHash||location.hash===c)return this.resolve(a,"get")};b.prototype.resolve=function(a,c){var d,f,b,e,h;f=(""+a).replace(this.RegExpCache.trimHash,"$1");if(""===f){if(-1===(""+a).indexOf("/"))return!1;f="/"}h=this.routes;for(b in h)if(k.call(h,
b)&&(d=h[b],d instanceof j&&(e=d.match(f))))return f=[e,c],d=$(d),d.trigger("simrou:any",f),null!=c&&"any"!==c&&d.trigger("simrou:"+c.toLowerCase(),f),!0;return!1};b.prototype.getHash=function(a){null==a&&(a=location.hash);return(""+a).replace(this.RegExpCache.extractHash,"$1")};b.prototype.resolveHash=function(a){var c;this.eventSupported&&(c=a.originalEvent.newURL);return this.resolve(this.getHash(c),"get")};b.prototype.handleFormSubmit=function(a){var c,d;c=$(a.target);d=c.attr("method")||c.get(0).getAttribute("method");
this.resolve(this.getHash(c.attr("action")),d)&&a.preventDefault();return!0};b.prototype.start=function(a,c,d){null==c&&(c=!0);null==d&&(d=!0);c&&($(window).on("hashchange",this.resolveHash),this.observingHash=!0);d&&($("body").on("submit","form",this.handleFormSubmit),this.observingForms=!0);c=this.getHash();if(""!==c)return this.resolve(c,"get");if(null!=a)return null!=window.history&&null!=window.history.replaceState?(window.history.replaceState({},document.title,"#"+a.replace(/^#+/,"")),this.resolve(a,
"get")):this.navigate(a)};b.prototype.stop=function(){$(window).off("hashchange",this.resolveHash);this.observingHash=!1;$("body").off("submit","form",this.handleFormSubmit);return this.observingForms=!1};return b}();j=function(){function b(c,d){var a,b;this.pattern=c;this.caseSensitive=null!=d?d:!0;c=""+this.pattern;b=c.match(this.RegExpCache.allParams);if(null!=b){var e,h,i;i=[];e=0;for(h=b.length;e<h;e++)a=b[e],i.push(a.substr(1));this.params=i}else this.params=[];c=c.replace(this.RegExpCache.escapeRegExp,
"\\$&");c=c.replace(this.RegExpCache.namedParam,"([^/]+)");c=c.replace(this.RegExpCache.splatParam,"(.*?)");this.expr=RegExp("^"+c+"$",d?"":"i")}var a;b.prototype.RegExpCache={escapeRegExp:/[-[\]{}()+?.,\\^$|#\s]/g,namedParam:/:(\w+)/g,splatParam:/\*(\w+)/g,firstParam:/(:\w+)|(\*\w+)/,allParams:/(:|\*)\w+/g};b.prototype.match=function(c){var a,b,g,e,h,i;a=this.expr.exec(c);if($.isArray(a)){g={};i=this.params;c=e=0;for(h=i.length;e<h;c=++e)b=i[c],g[b]=a[c+1]}else g=!1;return g};b.prototype.assemble=
function(){var c,a,b;b=1<=arguments.length?n.call(arguments,0):[];if(0<b.length)if($.isArray(b[0]))b=b[0];else if($.isPlainObject(b[0])){var g,e,h;e=this.params;h=[];a=0;for(g=e.length;a<g;a++)c=e[a],h.push(c in b[0]?b[0][c]:"");b=h}for(c=""+this.pattern;this.RegExpCache.firstParam.test(c);)a=0<b.length?b.shift():"",$.isFunction(a)&&(a=a(this)),c=c.replace(this.RegExpCache.firstParam,""+a);return c};b.prototype.toString=function(){return""+this.pattern};b.prototype.attachAction=function(c,a){null==
a&&(a="any");return $(this).on("simrou:"+a.toLowerCase(),c)};b.prototype.attachActions=function(a,b){var f,g,e;null==b&&(b="any");$.isPlainObject(a)||(e=[{},a],a=e[0],e=e[1],a[b]=e);e=[];for(b in a)k.call(a,b)&&(g=a[b],$.isArray(g)||(g=[g]),e.push(function(){var a,c,e;e=[];a=0;for(c=g.length;a<c;a++){f=g[a];e.push(this.attachAction(f,b))}return e}.call(this)));return e};b.prototype.detachAction=function(a,b){var f;null==b&&(b="any");"string"===typeof a&&(b=a);f="simrou:"+b.toLowerCase();return $.isFunction(a)?
$(this).off(f,a):$(this).off(f)};a=function(a){return function(b){return this.attachAction(b,a)}};b.prototype.get=a("get");b.prototype.post=a("post");b.prototype.put=a("put");b.prototype["delete"]=a("delete");b.prototype.any=a("any");return b}();window.Simrou=$.Simrou=l}).call(this);
