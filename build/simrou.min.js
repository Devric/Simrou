/* Simrou 1.0.0 / copyright 2012 büro für ideen */
(function(e,j,o){var h,p=/[-[\]{}()+?.,\\^$|#\s]/g,q=/:\w+/g,r=/\*\w*/g;h=function(a){var b=this,d,g=function(c,a){!a&&e.isFunction(c)&&(a=c,c="*");e(b).on("simrou:"+c,a);return b},f=function(c){return function(a){return g(c,a)}};b.match=function(a){a=d.exec(a);return!e.isArray(a)?!1:a.slice(1)};b.getRegExp=function(){return d};b.attachAction=g;b.detachAction=function(a,d){!d&&e.isFunction(a)&&(d=a,a="*");e(b).off("simrou:"+a,e.isFunction(d)?d:o);return b};b.get=f("get");b.post=f("post");b.put=f("put"); b["delete"]=b.del=f("delete");d=a instanceof RegExp?a:(a=(""+a).replace(p,"\\$&").replace(q,"([^/]+)").replace(r,"(.*?)"))?RegExp("^"+a+"$"):/^.+$/};j.Simrou=function(){var a=this,b=j.location,d={},g=!1,f=function(k){var d=b.hash!=k;b.hash=k;(!g||!d)&&c(k,"get");return a},c=function(a,b){var c=!1,f,g,i;if(!a)return!1;for(g in d)f=d[g],i=f.match(a),!1!==i&&(i.unshift(b),c=e(f),c.trigger("simrou:*",i),b&&c.trigger("simrou:"+b,i),c=!0);return c},l=function(){c(b.hash.replace(/^#*(.*)$/,"$1"),"get")}, n=function(){var a=e(this),b=(""+a.attr("method")).toLowerCase()||"get",a=a.attr("action");return!c(a,b)};a.version="1.0.0";a.registerRoute=function(a,b){var c=new h(a);b&&c.get(b);return d[""+c.getRegExp()]=c};a.removeRoute=function(b){b instanceof h||(b=new h(b));b=""+b.getRegExp();d[b]&&delete d[b];return a};a.start=function(d,h){h||(e(j).on("hashchange",l),g=!0);e("body").on("submit","form",n);var m=b.hash.replace(/^#*(.*)$/,"$1");""==m?d&&f(d):c(m,"get");return a};a.stop=function(){e(j).off("hashchange", l);g=!1;e("body").off("submit","form",n);return a};a.navigate=f;a.resolve=c}})(jQuery,window);