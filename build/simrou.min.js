/*
 Simrou v1.3.0 - Released under the MIT License.
 Copyright (c) 2012 büro für ideen, www.buero-fuer-ideen.de
*/
(function(){var g,i,j=function(c,a){return function(){return c.apply(a,arguments)}},h=Object.prototype.hasOwnProperty,k=Array.prototype.slice;i=function(){function c(a){this.handleFormSubmit=j(this.handleFormSubmit,this);this.resolveHash=j(this.resolveHash,this);this.routes={};this.observingForms=this.observingHash=!1;null!=a&&this.addRoutes(a)}c.prototype.eventSupported=function(){var a;a=window.document.documentMode;return"onhashchange"in window&&(null==a||7<a)}();c.prototype.addRoute=function(a,
b){var d;d=a instanceof g?a:new g(a);null!=b&&($.isFunction(b)?d.attachAction(b):d.attachActions(b));return this.routes[d.getRegExp().toString()]=d};c.prototype.addRoutes=function(a){var b,d,c,e;if($.isArray(a)){b=[];d=0;for(e=a.length;d<e;d++)c=a[d],b.push(this.addRoute(c))}else for(d in b={},a)h.call(a,d)&&(c=a[d],b[d]=this.addRoute(d,c));return b};c.prototype.removeRoute=function(a){a instanceof g||(a=new g(a));a=a.getRegExp().toString();if(a in this.routes)return delete this.routes[a]};c.prototype.navigate=
function(a){var b;b=location.hash!==a;location.hash=a;if(!this.observingHash||!b)return this.resolve(a,"get")};c.prototype.resolve=function(a,b){var d,c,e,f;if(null==a)return!1;f=this.routes;for(d in f)if(h.call(f,d)&&(e=f[d],e instanceof g&&(c=e.match(a))))return c.unshift(b),d=$(e),d.trigger("simrou:*",c),null!=b&&d.trigger("simrou:"+b.toLowerCase(),c),!0;return!1};c.prototype.getHash=function(a){null==a&&(a=location.hash);return a.replace(/^[^#]*#+(.*)$/,"$1")};c.prototype.resolveHash=function(a){var b;
this.eventSupported&&(b=a.originalEvent.newURL);return this.resolve(this.getHash(b),"get")};c.prototype.handleFormSubmit=function(a){var b,d;b=$(a.target);d=""+b.attr("method")||"get";this.resolve(b.attr("action"),d)&&a.preventDefault();return!0};c.prototype.start=function(a,b,d){null==b&&(b=!0);null==d&&(d=!0);b&&($(window).on("hashchange",this.resolveHash),this.observingHash=!0);d&&($("body").on("submit","form",this.handleFormSubmit),this.observingForms=!0);b=this.getHash();if(""!==b)return this.resolve(b,
"get");if(null!=a)return null!=window.history&&null!=window.history.replaceState?(window.history.replaceState({},document.title,"#"+a.replace(/^#+/,"")),this.resolve(a,"get")):this.navigate(a)};c.prototype.stop=function(){$(window).off("hashchange",this.resolveHash);this.observingHash=!1;$("body").off("submit","form",this.handleFormSubmit);return this.observingForms=!1};return c}();g=function(){function c(b){this.pattern=b;b instanceof RegExp?this.expr=b:null!=b?(b=(""+b).replace(this.escapeRegExp,
"\\$&"),b=b.replace(this.namedParam,"([^/]+)"),b=b.replace(this.splatParam,"(.*?)"),this.expr=RegExp("^"+b+"$")):this.expr=/^.+$/}var a;c.prototype.escapeRegExp=/[-[\]{}()+?.,\\^$|#\s]/g;c.prototype.namedParam=/:\w+/g;c.prototype.splatParam=/\*\w*/g;c.prototype.firstParam=/(:\w+)|(\*\w*)/;c.prototype.match=function(b){b=this.expr.exec(b);return $.isArray(b)?!1:b.slice(1)};c.prototype.getRegExp=function(){return this.expr};c.prototype.attachAction=function(b,a){null==a&&$.isFunction(b)&&(a=b,b="*");
return $(this).on("simrou:"+b.toLowerCase(),a)};c.prototype.attachActions=function(b,a){var c,e,f,a=$.isArray(b)?{"*":b}:$.isPlainObject(b)?b:new function(){return this[b]=a};f=[];for(b in a)h.call(a,b)&&(e=a[b],$.isArray(e)||(e=[e]),f.push(function(){var a,d,f;f=[];a=0;for(d=e.length;a<d;a++)c=e[a],f.push(this.attachAction(b,c));return f}.call(this)));return f};c.prototype.detachAction=function(b,a){var c;null==a&&$.isFunction(b)&&(a=b,b="*");c="simrou:"+b.toLowerCase();return $.isFunction(a)?$(this).off(c,
a):$(this).off(c)};c.prototype.assemble=function(){var b,a,c,e;e=1<=arguments.length?k.call(arguments,0):[];if(this.pattern instanceof RegExp)throw"Assembling routes that are based on a regular expression is not supported.";0<e.length&&$.isArray(e[0])&&(e=e[0]);a=this.pattern;for(b=0;this.firstParam.test(a);)c=null!=e[b]?$.isFunction(e[b])?e[b]():""+e[b]:"",a=a.replace(this.firstParam,c),b++;return a};a=function(a){return function(c){return this.attachAction(a,c)}};c.prototype.get=a("get");c.prototype.post=
a("post");c.prototype.put=a("put");c.prototype["delete"]=a("delete");return c}();window.Simrou=i}).call(this);
