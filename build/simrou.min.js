/*
 Simrou v1.4.0 - Released under the MIT License.
 Copyright (c) 2012 büro für ideen, www.buero-fuer-ideen.de
*/
(function(){var f,j,k=function(c,a){return function(){return c.apply(a,arguments)}},i=Object.prototype.hasOwnProperty,l=Array.prototype.slice;j=function(){function c(a){this.handleFormSubmit=k(this.handleFormSubmit,this);this.resolveHash=k(this.resolveHash,this);this.routes={};this.observingForms=this.observingHash=!1;null!=a&&this.addRoutes(a)}c.prototype.RegExpCache={extractHash:/^[^#]*(#.*)$/,trimHash:/^#*(.*?)\/*$/};c.prototype.eventSupported=function(){var a;a=window.document.documentMode;return"onhashchange"in
window&&(null==a||7<a)}();c.prototype.addRoute=function(a,b){var d;d=a instanceof f?a:new f(a);null!=b&&d.attachActions(b);return this.routes[d.getRegExp().toString()]=d};c.prototype.addRoutes=function(a){var b,d,c,g;if($.isFunction(a))b=a.call(this);else if($.isArray(a)){b=[];d=0;for(g=a.length;d<g;d++)c=a[d],b.push(this.addRoute(c))}else for(d in b={},a)i.call(a,d)&&(c=a[d],b[d]=this.addRoute(d,c));return b};c.prototype.removeRoute=function(a){a instanceof f||(a=new f(a));a=a.getRegExp().toString();
if(a in this.routes)return delete this.routes[a]};c.prototype.navigate=function(a){var b;b=this.getHash();location.hash=a;if(!this.observingHash||location.hash===b)return this.resolve(a,"get")};c.prototype.resolve=function(a,b){var d,c,g,e,h;d=(""+a).replace(this.RegExpCache.trimHash,"$1");if(""===d){if(-1===(""+a).indexOf("/"))return!1;d="/"}h=this.routes;for(g in h)if(i.call(h,g)&&(e=h[g],e instanceof f&&(c=e.match(d))))return c.unshift(b),d=$(e),d.trigger("simrou:any",c),null!=b&&"any"!==b&&d.trigger("simrou:"+
b.toLowerCase(),c),!0;return!1};c.prototype.getHash=function(a){null==a&&(a=location.hash);return(""+a).replace(this.RegExpCache.extractHash,"$1")};c.prototype.resolveHash=function(a){var b;this.eventSupported&&(b=a.originalEvent.newURL);return this.resolve(this.getHash(b),"get")};c.prototype.handleFormSubmit=function(a){var b,d;b=$(a.target);d=b.attr("method")||b.get(0).getAttribute("method");this.resolve(this.getHash(b.attr("action")),d)&&a.preventDefault();return!0};c.prototype.start=function(a,
b,d){null==b&&(b=!0);null==d&&(d=!0);b&&($(window).on("hashchange",this.resolveHash),this.observingHash=!0);d&&($("body").on("submit","form",this.handleFormSubmit),this.observingForms=!0);b=this.getHash();if(""!==b)return this.resolve(b,"get");if(null!=a)return null!=window.history&&null!=window.history.replaceState?(window.history.replaceState({},document.title,"#"+a.replace(/^#+/,"")),this.resolve(a,"get")):this.navigate(a)};c.prototype.stop=function(){$(window).off("hashchange",this.resolveHash);
this.observingHash=!1;$("body").off("submit","form",this.handleFormSubmit);return this.observingForms=!1};return c}();f=function(){function c(b){this.pattern=null!=b?b:/^.+$/;this.pattern instanceof RegExp?this.expr=this.pattern:(b=(""+this.pattern).replace(this.RegExpCache.escapeRegExp,"\\$&"),b=b.replace(this.RegExpCache.namedParam,"([^/]+)"),b=b.replace(this.RegExpCache.splatParam,"(.*?)"),this.expr=RegExp("^"+b+"$"))}var a;c.prototype.RegExpCache={escapeRegExp:/[-[\]{}()+?.,\\^$|#\s]/g,namedParam:/:\w+/g,
splatParam:/\*\w*/g,firstParam:/(:\w+)|(\*\w*)/};c.prototype.match=function(b){b=this.expr.exec(b);return $.isArray(b)?b.slice(1):!1};c.prototype.assemble=function(){var b,a,c;c=1<=arguments.length?l.call(arguments,0):[];if(this.pattern instanceof RegExp)throw"Assembling routes that are based on a regular expression is not supported.";0<c.length&&$.isArray(c[0])&&(c=c[0]);for(b=""+this.pattern;this.RegExpCache.firstParam.test(b);)a=0<c.length?c.shift():"",$.isFunction(a)&&(a=a(this)),b=b.replace(this.RegExpCache.firstParam,
""+a);return b};c.prototype.getRegExp=function(){return this.expr};c.prototype.attachAction=function(b,a){null==a&&(a="any");return $(this).on("simrou:"+a.toLowerCase(),b)};c.prototype.attachActions=function(b,a){var c,g,e;null==a&&(a="any");$.isPlainObject(b)||(e=[{},b],b=e[0],e=e[1],b[a]=e);e=[];for(a in b)i.call(b,a)&&(g=b[a],$.isArray(g)||(g=[g]),e.push(function(){var b,e,f;f=[];b=0;for(e=g.length;b<e;b++){c=g[b];f.push(this.attachAction(c,a))}return f}.call(this)));return e};c.prototype.detachAction=
function(a,c){var f;null==c&&(c="any");"string"===typeof a&&(c=a);f="simrou:"+c.toLowerCase();return $.isFunction(a)?$(this).off(f,a):$(this).off(f)};a=function(a){return function(c){return this.attachAction(c,a)}};c.prototype.get=a("get");c.prototype.post=a("post");c.prototype.put=a("put");c.prototype["delete"]=a("delete");c.prototype.any=a("any");return c}();window.Simrou=$.Simrou=j}).call(this);
