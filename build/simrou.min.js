/*
 Simrou v1.3.0 - Released under the MIT License.
 Copyright (c) 2012 büro für ideen, www.buero-fuer-ideen.de
*/
(function(){var g,i,j=function(c,b){return function(){return c.apply(b,arguments)}},h=Object.prototype.hasOwnProperty,k=Array.prototype.slice;i=function(){function c(b){this.handleFormSubmit=j(this.handleFormSubmit,this);this.resolveHash=j(this.resolveHash,this);this.routes={};this.observingForms=this.observingHash=!1;null!=b&&this.addRoutes(b)}c.prototype.eventSupported=function(){var b;b=window.document.documentMode;return"onhashchange"in window&&(null==b||7<b)}();c.prototype.addRoute=function(b,
a){var d;d=b instanceof g?b:new g(b);null!=a&&($.isFunction(a)?d.attachAction(a):d.attachActions(a));return this.routes[d.getRegExp().toString()]=d};c.prototype.addRoutes=function(b){var a,d,c,e;if($.isArray(b)){a=[];d=0;for(e=b.length;d<e;d++)c=b[d],a.push(this.addRoute(c))}else for(d in a={},b)h.call(b,d)&&(c=b[d],a[d]=this.addRoute(d,c));return a};c.prototype.removeRoute=function(b){b instanceof g||(b=new g(b));b=b.getRegExp().toString();if(b in this.routes)return delete this.routes[b]};c.prototype.navigate=
function(b){location.hash=b;if(!this.observingHash||!this.isChange)return this.resolve(b,"get")};c.prototype.resolve=function(b,a){var d,c,e,f;if(null==b)return!1;f=this.routes;for(d in f)if(h.call(f,d)&&(e=f[d],e instanceof g&&(c=e.match(b))))return c.unshift(a),d=$(e),d.trigger("simrou:*",c),null!=a&&d.trigger("simrou:"+a.toLowerCase(),c),!0;return!1};c.prototype.getHash=function(b){null==b&&(b=location.hash);return b.replace(/^[^#]*#+(.*)$/,"$1")};c.prototype.resolveHash=function(b){var a;this.eventSupported&&
(a=b.originalEvent.newURL);return this.resolve(this.getHash(a),"get")};c.prototype.handleFormSubmit=function(b){var a,d;a=$(b.target);d=""+a.attr("method")||"get";this.resolve(a.attr("action"),d)&&b.preventDefault();return!0};c.prototype.start=function(b,a,d){var c=this;null==a&&(a=!0);null==d&&(d=!0);a&&($(window).on("hashchange",this.resolveHash),this.observingHash=!0);d&&($("body").on("submit","form",this.handleFormSubmit),this.observingForms=!0);a=this.getHash();if(""!==a)return this.resolve(a,
"get");if(null!=b)return null!=window.history&&null!=window.history.replaceState?(window.history.replaceState({},document.title,"#"+b.replace(/^#+/,"")),this.resolve(b,"get")):$(function(){return c.navigate(b)})};c.prototype.stop=function(){$(window).off("hashchange",this.resolveHash);this.observingHash=!1;$("body").off("submit","form",this.handleFormSubmit);return this.observingForms=!1};return c}();g=function(){function c(a){this.pattern=a;a instanceof RegExp?this.expr=a:null!=a?(a=(""+a).replace(this.escapeRegExp,
"\\$&"),a=a.replace(this.namedParam,"([^/]+)"),a=a.replace(this.splatParam,"(.*?)"),this.expr=RegExp("^"+a+"$")):this.expr=/^.+$/}var b;c.prototype.escapeRegExp=/[-[\]{}()+?.,\\^$|#\s]/g;c.prototype.namedParam=/:\w+/g;c.prototype.splatParam=/\*\w*/g;c.prototype.firstParam=/(:\w+)|(\*\w*)/;c.prototype.match=function(a){a=this.expr.exec(a);return!$.isArray(a)?!1:a.slice(1)};c.prototype.getRegExp=function(){return this.expr};c.prototype.attachAction=function(a,d){null==d&&$.isFunction(a)&&(d=a,a="*");
return $(this).on("simrou:"+a.toLowerCase(),d)};c.prototype.attachActions=function(a,d){var b,c,f;$.isArray(a)?d={"*":a}:$.isPlainObject(a)?d=a:(f={},f[a]=d,d=f);f=[];for(a in d)h.call(d,a)&&(c=d[a],$.isArray(c)||(c=[c]),f.push(function(){var d,f,g;g=[];d=0;for(f=c.length;d<f;d++){b=c[d];g.push(this.attachAction(a,b))}return g}.call(this)));return f};c.prototype.detachAction=function(a,d){var b;null==d&&$.isFunction(a)&&(d=a,a="*");b="simrou:"+a.toLowerCase();return $.isFunction(d)?$(this).off(b,
d):$(this).off(b)};c.prototype.assemble=function(){var a,b,c,e;e=1<=arguments.length?k.call(arguments,0):[];if(this.pattern instanceof RegExp)throw"Assembling routes that are based on a regular expression is not supported.";0<e.length&&$.isArray(e[0])&&(e=e[0]);b=this.pattern;for(a=0;this.firstParam.test(b);)c=null!=e[a]?$.isFunction(e[a])?e[a]():""+e[a]:"",b=b.replace(this.firstParam,c),++a;return b};b=function(a){return function(b){return this.attachAction(a,b)}};c.prototype.get=b("get");c.prototype.post=
b("post");c.prototype.put=b("put");c.prototype["delete"]=b("delete");return c}();window.Simrou=i}).call(this);
